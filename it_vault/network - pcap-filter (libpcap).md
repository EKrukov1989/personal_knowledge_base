libpcap - платформонезависимая библиотека с открытым исходным кодом, которая позволяет перехватывать сетевые пакеты.

В libpcap можно настроить фильтр захвата пакетов, большая часть этого документа будет посвящена как раз языку описания фильтров.

>[!note]
>libpcap захватывает пакеты, которые удовлетворяют требованиям фильтра.

Подробная информация про язык фильтров -> `man pcap-filter`

### 1. Общая структура выражения

Фильтр состоит из последовательности примитивов, которые связаны операторами `and/or`. Также каждый примитив может быть предварен оператором `not`.

Описание: `[not] primitive [and|or [not] primitive ...]`
Пример: `primitive_1 and not primitive_2 or primitive_3`

### 2. Примитивы

Примитив имеет следующую структуру:
`[proto] [dir] [type] id`

##### 2.1. Type
`type` указывает на тип идентификатора. `type` может принимать одно из следующих значений: `host | net | | port | portrange`
По умолчанию `type` принимается равным `host`.

##### 2.2. Id
Идентификатор должен соответствовать указанному типу. Примеры:
- `host` -> `foo` или `192.168.213.200`
- `net` ->`128.3`
- `port` -> `20`
- `portrange` -> `6000-6008`

##### 2.3. Dir
`dir` указывает направление пакетов, которые должны пройти фильтр.
Может принимать одно из следующих значений:
- `src | dst | src or dst | src and dst` и др.
По умолчанию `src or dst`.

##### 2.4. Proto
`proto` отфильтровывает пакеты, которые не соответствую определенному протоколу. Может принимать одно из следующих значений:
`ether|fddi|tr|wlan|ip|ip6|arp|rarp|decnet|sctp|tcp|udp`
По умолчанию - любой протокол проходит фильтр.

>[!note]
>Одинаковые квалификаторы могут быть пропущены. А именно:
>`tcp dst port ftp or ftp-data` ->
>-> `tcp dst port ftp or tcp dst port ftp-data`
>хотя если подставить квалификаторы по умолчанию должно быть:
>-> `tcp dst port ftp or any src or dst host ftp-data`

