С помощью утилиты tcpdump можно посмотреть сетевые пакеты, которые отправляются с данного хоста или приходят на хост.

Синтаксис довольно простой: `tcpdump [options] [expression]`

### 1. Options

- `-A` -> выводить все пакеты ASCII
- `-c <count>` -> вывести только `count` пакетов и затем завершить работу
- `-e` -> выводит заголовок канального уровня для каждой строки
- `-F <filename>` -> взять filter expression из `filename`
- `-i <interface>` -> выводить пакеты только от `interface`
- `-#, --number` -> выводить необязательный номер пакета в начале каждой строки
- `-Q, --direction=<in|out|inout>` -> выводить только входящие, исходящие пакеты или все
- `-t` -> не выводить таймстемпы
- `-w <filename>` -> писать пакеты в `filename` и не выводить их

### 2. Expression

С помощью expression можно отфильтровать траффик. Правила написания expression довольно обширны, поэтому обойдемся самымм употребимыми:

`host <hostname>` - выводить только траффик от или для `<hostname>`
`host <h1> and <h2>` - выводить только траффик между `h1` и `h2`

tcpdump, как и wireshark использует библиотеку libpcap. Поэтому правила составления выражений для фильтров можно почитать здесь: [[network - pcap-filter (libpcap)]].