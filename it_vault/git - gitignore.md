___
>[!note] Основано на `man gitignore.5`

Файлы `.gitignore` определяют набор файлов, которые git не должен остлеживать. Однако, это не распространяется на файлы, которые уже являются отслеживаемыми.

___
### 1. Источники паттернов

Чтобы определить, требует Файл отслеживания или нет, git проверяет паттерны в нескольких источниках в следующем порядке:
- паттерны, переданные непосредственно в команде
- паттерны в файле `.gitignore` в той же директории что и Файл
- паттерны в файле `.gitignore` во всех родительских директориях вплоть до рабочей директории
- паттерны из `$GIT_DIR/info/exclude`
- паттерны из файла, который указан в переменной `core.excludesFile`

Сами файлы `.gitignore` не игорируются, они являются частью проекта и их принято коммитить. Поэтому в эти файлы следует класть паттерны, которыми будут пользоваться все пользователи репозитория.

Иногда  пользователю нужно добавить свои паттерны, которые не следует коммитить. Например, если пользователь использует `vscode` и хочет скрыть папку `.vscode`, но другие пользователи могут пользоваться другими IDE и им этот паттерн ни к чему.

В таких случаях нужно использовать `$GIT_DIR/info/exclude` (распространяется на репозиторий) или `core.excludesFile` (распространяется на пользователя).  

___
### 2. Формат паттернов

Каждый источник паттернов содержит несколько строк и каждая строка содержит один паттерн. Правила составления паттернов:
##### 2.1. Комментарии 

Пустые линии и линии начинающиеся со знака # - считают комментариями
##### 2.2. Глоббинг

В общем и целом паттерны работают по принципам глоббинга. Работают следующие wildcard-выражения:
- `*` -> любая последовательно символов кроме слэшей
- `?` -> любой символ, кроме слэша
- `[]` -> любой символов из списка
- `**` -> globstar
##### 2.3. Отрицание

Если паттерн предварен восклицательным знаком (!), то все файлы подходящие под этот паттерн не будут проигнорированы.
Однако если родительская директория исключена, то даже это не сработает.
##### 2.3. Разделители директорий

Прямой слэш в паттернах используется как разделитель между директориями.
Правила его использования следующие:
- По умолчанию если в паттерне нет слэшей, то считается что он может быть применен к любому файлу или директории в директории данного файла gitignore или же любой поддириктории.
- Если есть прямой слэш в начале или середине паттерна, то считается что этот паттерн относителен директории, в которой находится данный gitignore.
- Если паттерн заканчивается прямым слэшем - он подходит только для директорий. В противном случае паттерн подходит и для директорий и для файлов.

Примеры:
```
pattern:    abc.txt 
match:      abc.txt a/abc.txt a/b/abc.txt (даже если abc.txt - директория)
not-match:  

pattern:    abc/def.txt или /abc/def.txt
match:      /abc/def.txt
not-match:  a/abc/def.txt

pattern:    abc/
match:      abc a/abc a/b/abc (только если abc - директория)
not-match:  

pattern:    /abc/
match:      abc (только если abc - директория)
not-match:  
```

___
### 3. Практика с несколькими gitignore

В этой статье не будет рассматриваться экзотические случаи.
Будет считать что есть только файлы `.gitignore` в рабочей директории.

Допустим у нас есть три директории: `/` , `/a` и `/a/b`. В каждой из этих директорий есть файл `.gitignore`.

Мы можем представить их содержимое вот в такой обощенной форме:

```
/.gitignore
pattern_1
pattern_2
pattern_3

/a/.gitignore
pattern_4
pattern_5
pattern_6

/a/b/.gitignore
pattern_7
pattern_8
pattern_9
```

Именно в таком порядке git будет считывать паттерны:
- начиная с рабочей директории и затем в поддиректориях
- начиная с первой строки и заканчивая последней

>[!note]
>Наличие `.gitignore` в поддиректории не отменяет вышестоящих `.gitignore`. Они все будут прочитаны и исполнены.

Если мы рассматриваем обычные паттерны, то порядок не имеет особого значения, так как любой файл, который подходит к одному из паттернов, будет проигнорирован.

Для отрицания порядок имеет первостепенное значение.
Например:
Если в последнем файле на последней строчке написано `!abc.txt`, то файл `abc.txt` точно не будет проигнорирован и наоборот.

