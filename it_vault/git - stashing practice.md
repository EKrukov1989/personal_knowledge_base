___
Stashing - удобный способ сохранения изменений в рабочей директории и индексе, без создания коммитов.

___
### 1. Альтернативный вариант

Допустим у нас есть изменения в репозитории, которые мы хотим застэшить.
Этого можно добиться с помощью создания новой ветки:

```bash
# сначала положить все изменения, которые следует застэшить в индекс
git checkout -B stash_branch
git commit -q -m tmp_commit
```

Далее можно продолжить работу.
Чтобы вернуться к сделанным изменениям нужно:
```bash
git checkout stash_branch
git reset --soft @~1
```

Теперь сохраненные изменения снова в индексе, их можно перекоммитить.
Однако, при таком подходе можно сохранять только то, что в индексе.

___
### 2. Stashing

Stashing (припрятывание) позволяет сохранить текущие изменения и потом восстановить их с наименьшими трудозатратами.
##### 2.1. Припрятывание

`git stash`
- припрятать все изменения в рабочей директории и индексе
- стереть все изменения в рабочей директории и индексе
- `untrucked` и `ignored` файлы не прячутся и не стираются
Опции:
`--keep-index`
- не очищать индекс
`--include-untracked`
- припрятать также `untracked` файлы и стереть их из рабочей директории
`--all` 
- припрятать также `untracked` и `ignored` файлы и стереть их из рабочей директории
___
##### 2.2. Просмотр

`git stash list` 
- посмотреть список припрятанных изменений

`stashed list` выглядит вот так:
```
stash@{0}: WIP on <branch_name>: <commit_hash> <commit_message>
stash@{1}: WIP on <branch_name>: <commit_hash> <commit_message>
stash@{2}: WIP on <branch_name>: <commit_hash> <commit_message>
```
Префикс в начале строки (`stash@{i}`) является идентификатором.

`git stash show -p stash@{i}`
- посмотреть дифф для указанного стэша
___
##### 2.3. Удаление

`git stash drop [stash@{i}]`
- удалить указанный стэш
- если идентификатор стэша не указан, то будет удален стэш, припрятаннный последним ( `stash@{0}` )
___
##### 2.4. Применение

При применении стэша все изменения, что были сохранены в стэше, перемещаются 
в рабочую директорию и индекс.
Изменения необязательно применять на том же коммите, на котором они были сделаны.

>[!warning] При применении стэша рабочая директория должна быть чистой!

`git stash apply [stash@{i}]`
- применить указанный стэш
- если идентификатор стэша не указан, то будет применен стэш, припрятаннный последним ( `stash@{0}` )

`git stash pop [stash@{i}]`
- то же что и apply, только после применения стэш будет удален

`git stash branch <new_branch_name>`
- создать новую ветку на коммите где был припрятан последний стэш и чекаутит эту ветку
- применяет изменения
- удаляет стэш если все прошло успешно

