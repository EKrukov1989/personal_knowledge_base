___
Join (соединение) - операция над двумя таблицами, которая позволяет в результате получить новую таблицу. Существует несколько разновидностей соединений.
___
### 1. Cross join (Декартово произведение)

Есть две таблицы:
##### Таблица names (n строк)

person_id | name 
-|-
11|Alice
13|Bob
17|Carol
##### Таблица accounts (m строк)

person_id | account
-|-
11|200
13|300

В результате cross join мы получим таблицу, которая будет содержать n\*m строк, причем каждая строка результирующей таблицы будет склеена из одной строки таблицы names и одной строки таблицы accounts. Результат:

```sql
SELECT * names JOIN accounts;
```

person_id|name|person_id|account
-|-|-|-
11|Alice|11|200
13|Bob|11|200
17|Carol|11|200
11|Alice|13|300
13|Bob|13|300
17|Carol|13|300

>[!tip]
>Если требуется декартово произведение, лучше явно прописать: `CROSS JOIN`

___
### 2. Inner join

Inner join - это декартово произведение с некоторым условием. В результате применения этого условия в результирующем наборе остаются только те строки, которые удобвлетворяют условию. Например:
```sql
SELECT * names n JOIN accounts a ON n.person_id = a.person_id;
```

person_id|name|person_id|account
-|-|-|-
11|Alice|11|200
13|Bob|13|300

>[!note]
>По умолчанию всегда подразумевается `INNER JOIN` если не записано иное.

>[!note]
>Если в блоке `ON` используется равенство, то такое соединение называется - эквисоединение. Однако можно использовать и другие условия, например неравенства.

___
### 3. Соединение нескольких таблиц

Соединение нескольких таблиц можно рассматривать как последовательное соединение сначала первых двух таблиц, а затем соединение результирующего набора с последующими таблицами. Т.е.:
- `a JOIN b JOIN c ON ...` <=> `(a JOIN b ON ...) JOIN c ON ...`

>[!note]
>При перемене таблиц местами в множественном соединении результат не изменяется.

___
### 4. Outer join

Существует два вида внешних соединений: `LEFT OUTER JOIN` и `RIGHT OUTER JOIN`

`LEFT OUTER JOIN` отличается от `INNER JOIN` тем, что если какая-либо строка из левой таблицы не может быть соединена с другими строками из правой таблицы, то она все равно будет добавлена в результирующий набор:
```sql
SELECT * names n LEFT OUTER JOIN accounts a ON n.person_id = a.person_id;
```

person_id|name|person_id|account
-|-|-|-
11|Alice|11|200
13|Bob|13|300
17|Carol|NULL|NULL

Аналогично для правого соединения:
```sql
SELECT * names n RIGHT OUTER JOIN accounts a ON n.person_id = a.person_id;
```

person_id|name|person_id|account
-|-|-|-
11|Alice|11|200
13|Bob|13|300

>[!note]
>Слово `OUTER` необязательно, можно писать просто `LEFT JOIN` или `RIGHT JOIN`

___
### 5. Natural join

При естественном соединении MySQL делает предположение о необходимом условии соединения, основываясь на именах стоблцов. Если в обеих таблицах есть столбцы с одинаковыми именами, то соединение будет произведено по ним.
```sql
SELECT * names NATURAL JOIN accounts;
```

>[!tip] Я не собираюсь использовать эту потенциально опасную фичу.

___
### 6. Сокращения

Есть пять видов соединений, однако нет смысла писать их все в полной форме:
- `... INNER JOIN ... ON ...` -> `INNER` не писать
- `... LEFT OUTER JOIN ... ON ...` -> `OUTER` можно не писать
- `... RIGHT OUTER JOIN ... ON ...` -> лучше поменять таблицы местами
- `... NATURAL JOIN ...` -> лучше не использовать
- `... CROSS JOIN ...` -> если действительно нужно - писать в полной форме. Однако это довольно редкий случай
В итоге на самом деле нужны только следующие формы:
- `... JOIN ... ON ...`
- `... LEFT JOIN ... ON ...`
