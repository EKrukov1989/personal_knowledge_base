>[!warning] Это обзорная статья, только для общего представления.

UFW (uncomplicated firewall) - это инструмент для настройки сетевой защиты. UFW имеет дружественный интерфейс и позволяет настроить netfilter даже людям не знакомым с iptables.

Настройки UFW по умолчанию прекрасно подходят для среднестастического домашнего пользователя.

Вкратце о настройках UFW по умолчанию:
- все входящие отвергаются (deny) с минимальными исключениями

### 1. Просмотр текущего состояния UFW

В ubuntu ufw по умолчанию выключен. Но состояние UFW можно изменять и просматривать, даже при выключенном фаерволе.

Включить/выключить UFW:
- `sudo ufw enable
- `sudo ufw disable`

Проверить состояние ufw можно с помощью команды: 
- `sudo ufw status`
- `sudo ufw status verbose`
Пример вывода команды ufw status:
```
Status: active
Logging: on (low)
Default: deny (incoming), allow (outgoing)
New profiles: skip
```

### 2. Cинтаксис правил

Есть два вида синтаксиса правил в UFW:
- упрощенный, в котором можно определять правила для портов, протоколов и направлений трафика
- полный, в котором еще можно определять диапазоны входных и выходных IP-адресов

##### 2.1. Упрощенный синтаксис

Структура:
`ufw ACTION DIR [PORT[/PROTOCOL] | APPNAME] [comment COMMENT]`

`ACTION` может принимать одно из четырех значений:
- `allow` разрешает трафик
- `deny` - отвергает трафик, просто игнорирует его
- `reject` - отвергает траффик и посылает ответное сообщение
- `limit` - разрешает соединения, но не позволяет совершать более 6 попыток соединения с одного IP-адреса в течение 30 секунд.

`DIR` может принимать одно из двух значений:
- `in` - входящий трафик
- `out` - исходящий трафик
По умолчанию `DIR` имеет значение `in`.

Примеры
```
ufw allow 53
ufw allow 25/tcp
ufw allow out smtp
ufw reject telnet comment 'telnet is unencrypted'
```

##### 2.1. Полный синтаксис

Полный синтаксис позволяет дополнительно указать:
- входные и выходные IP-адреса или диапазоны адресов
- интерфейсы

`ufw allow|deny|reject|limit [in|out [on INTERFACE]] [proto PROTOCOL] [from ADDRESS [port PORT | app APPNAME ]] [to ADDRESS [port PORT | app APPNAME ]] [comment COMMENT]`

Примеры:
```
ufw deny proto tcp to any port 80 comment 'web app'
ufw deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 25
ufw deny proto tcp from 2001:db8::/32 to any port 25
ufw deny in on eth0 to 224.0.0.1 proto igmp
ufw allow proto tcp from any to any port 80,443,8080:8090
```

По умолчанию UFW применяет правило ко всем доступным интерфейсам.

### 3. Доступные операции

##### 3.1. Администрирование

`reload`
- перезагрузить фаервол
`default allow|deny|reject DIRECTION`
- изменить политику по умолчанию. для траффика в направлении `DIRECTION`, где `DIRECTION` может иметь одно из следующих значений: `incoming, outgoing, routed`
`reset` 
- деактивировать фаервол и вернуть его к установочным настройкам
`status`
-  показать статус фаервола и правила ufw
`show REPORT`
- вывести отчет о работе фаервола

###### 3.2. Управление правилами

`allow ARGS`
`deny ARGS`
`reject ARGS`
`limit ARGS`
- добавить новое правил

`delete RULE|NUM`
`insert NUM RULE`,
`prepend RULE`
- удалить или вставить правило

>[!note] Вывод
>В целом UFW полезно только своими настройками по умолчанию и возможностью легко открыть/закрыть парочку портов. Если нужно сделать что-то серьезное - UFW не менее сложная запутанная хрень.