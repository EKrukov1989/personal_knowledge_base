___
В данной статье описываются основные понятия googletest.
___
### 1. Test case и test suite

Тестовая программа ([[gtest - testapp]]) содержит один или несколько тестов (`test`, `test case`). Каждый тест - это функция, по возможности изолированная и повторяемая, которая проверяет некоторую функциональность.

Тесты объединены в наборы. Именованный набор тестов называется `Test Suite`.

Все тесты обычно храняться в отдельных файлах, которые принято называть добавляя в конце слово Test. Пример теста `SomeClassTest.cpp`:
```cpp
#include "gtest/gtest.h"

TEST(TestSuiteName, TestName_1) {
	// test body
}

TEST(TestSuiteName, TestName_2) {
	// test body
}
```

>[!warning] Имена тестов не должны содержать знаков подчеркивания!

___
### 2. Assertions

Каждый тест должен содержит одно или несколько утверждений (кроме краш-тестов, в которых может не быть утверждений).

Утверждение (assertion) в googletest это макрос, который проверяет некоторое условие. В результате вычисления утвержения может быть три результата:
- success
- nonfatal failure
- fatal failure

Если одно из утверждений окажется ложным, то весь тест будет провален. Кроме того может быть выведено некоторое сообщение.

Существует два типа утверждений:
`EXPECT_*`-> ложное утверждение приводит к `nonfatal failure` и тест продолжается
`ASSERT_*` -> ложное утверждение приводит к `fatal failure` и выполнение теста прерывается

Примеры утверждений:
```cpp
ASSERT_EQ(1, 2) << "message";  // будет напечатано, если утервждение ложно
EXPECT_EQ(1, 2)
```

Перечень доступных устверждений: [[gtest - assertions reference]]
___
### 3. Test Fixtures

Тест фикстура в первую очередь нужна, чтобы подготовить объекты, которые могут потребоваться во нескольких тестах. Так же в классе фикстуры можно определить функции, которые могут понадобиться в нескольких тестах.

Гуглтест для каждого теста создает новый объект фикстуры перед запуском теста, а затем уничтожает его после завершения теста. Гуглтест никогда не использует один объект фикстуры для нескольких тестов.

Для создания и уничтожения объектов фикстуры можно использовать конструктор/деструктор или функции SetUp/TearDown. Обычно удобнее использовать конструктор/деструктор, потому что они будут гарантировано вызваны, а функции нужно вызывать намеренно. Но в некоторых случаях нужны SetUp/TearDown:
- нужно использовать виртуальные функции
- нужно использовать `ASSERT_*`
- могут быть выброшены исключения

Чтобы использовать фикстуру нужно:
- унаследовать `::testing::Test`
- все нужные переменные и методы объявить `protected`
- для тестов использовать макрос `TEST_F`, вместо имени `test suite` указать имя класса фикстуры

Пример использования фикстуры:
```cpp
#include "gtest/gtest.h"

class MyTestFixture : public ::testing::Test
{
public:
	void SetUp() override { std::cout << "SetUp\n"; };
	void TearDown() override {std::cout << "TearDown\n";};
protected:
	const int mv_ = 17;
	void me_() { std::cout << "protected method\n"; };
};

TEST_F(MyTestFixture, TestName)
{
	me_();
	ASSERT_EQ(mv_, 13); 
	// TearDown все равно будет вызван даже после проваленного ASSERT
}
```
___
### 4. Тестирование приватных функций

Пример:
```cpp
#include "gtest/gtest.h"

class MyTestFixture;

class A
{
	friend MyTestFixture;
	FRIEND_TEST(MyTestFixture, TestName );
private:
	void foo() { std::cout << "foo\n"; };
};

class MyTestFixture : public ::testing::Test, public A {};

TEST_F( MyTestFixture, TestName )
{
	A a;
	a.foo();
}
```

