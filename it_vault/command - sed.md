___
Основано на: https://www.gnu.org/software/sed/manual/sed.html

sed (stream editor) - это программа, выполняющая некоорые базовые преобразования над стандартным вводом.

Краткая шпаргалка:

action | syntax
-|-
substitute | `sed 's/regexp/replacement/flags', где flags = g,i `
transliterate | `sed 'y/source-chars/dest-chars/'`
append | `sed 'a text'`, `sed 'a\<multiline_text>'`
insert | `sed 'i text'`, `sed 'i\<multiline_text>'`
replace | `sed 'c text'`, `sed 'c\<multiline_text>'`
delete | `sed '[addr]d'`
print | `sed -n '[addr]p'`
read | `sed '[addr]r filename'`
write | `sed '[addr]w filename'`
quit | `sed '[addr]q'`,

___
### 1. Синтаксис

`sed [options] SCRIPT INPUTFILE...`
- получить текст из `INPUTFILE`, результат вывесть в `stdout`
- если несколько входящих файлов, то они интерпретируются как один длинный файл

`sed [options] SCRIPT`
`sed [options] SCRIPT -`
- получить текст из `stdin`, результат вывесть в `stdout`

`sed -i [options] SCRIPT INPUTFILE...`
- изменить  `INPUTFILE`, ничего не выводить
___
### 2. Опции

`-E`
`-r`
`--regexp-extended`
- использовать ERE, по умолчанию BRE ([[regex - basic syntax]])

`-n`
- не выводить обрабатываемые строчки 

`-e script, --expression=script`
`-f script-file, --file=script-file`
- указать скрипт или файл со скриптом, при использовании этих опций в команде уже не не нужно прописывать `SCRIPT`

___
### 3. Скрипт

Скрипт может содержать одну или несколько команд, разделенных точкой с запятой или символом перевода строки.

Синтаксис команд:
- `[addr]X[options]`, где `X` - буква, означающая определенную команду
- `[addr]{X[options] ; X[options] ; ...}`

`[options]` -> особые опции для определенной команды

`[addr]` -> определяет набор строк, на которых будет выполнена команда `X`.
Адрес может иметь следующую форму:
- номер строки -> `30`
- диапазон строк -> `30,35`
- регулярное выражение -> `/^foo/`

>[!note]
>Команды в скрипте могут быть предварены необязательными пробелами для лучшей читаемости: `'/^foo/d ; s/hello/world/'`
> 

___
### 4. Адреса

С помощью адреса указывается область действия команды

>[!warning] Нумерация строк ведется с единицы!.

Правила задания адреса:
1. Адрес не указан -> команда выполняется на всех строках
2. Указан один номер -> команда выполняется только на строке с соответствующим номером.
3. Указано два номера, разделенных запятой -> команда выполняется на всех строках строке в этом интервале, включительно. Например: `4,6`
4. Указано регулярное выражение -> команда выполняется только на строках, которые содержат подстроки, подходящие под регулярное выражение. Регулярное выражение оформляется двумя прямыми слэшами с двух сторон. Пример: `\apple\`
5. Если в конце адреса указан восклицательный знак ( ! )-> то условие инвертируется. Например: `4,17!p`

___
### 5. Команды

##### 5.1. Команда `s` (substitute)

Синтаксис: `s/regexp/replacement/flags`
Заменить первую подстроку в строке, подходящую к `regexp`, на строку `replacement`.

Flags:
`g` -> заменить все подходящие подстроки в строке
`number` -> заменить только подстроку в строку под номером `number`
`i` -> регулярное выражение нечуствительно к регистру
___
##### 5.2. Команда `q` (quit)

Синтаксис: `[addr]q`, причем `addr` может быть только номером
Команда выводит в стандартный вывод указанное количество строк (`addr`) и затем завершает выполнение.
___
##### 5.3. Команда `d` (delete)

Удалить строки в соответствии с указанными адресом.
Синтаксис: `[addr]d`
___
##### 5.4. Команда `p` (print)

Напечатать строки, которые соответствуют адресу.
Синтаксис: `-n [addr]p`
Если не указать опцию `-n`, то помимо подходящий строк, буду выведены еще все строки, в том числе подходящие - еще раз.
___
##### 5.5. Команда `y` (transliterate)

Синтаксис: `y/source-chars/dest-chars/`

`source-chars` и `dest-chars`  должны содержать одинаковое количество символов (escape-символы считаются за один символ).

Аналог команды `tr`.
___
##### 5.6. Команда `a` (append)

Добавить текст в конец строки:
Синтаксис: `a text`

Добавить строку с текстом после строки:
Синтаксис: 
```
sed 'a\
text' inputfile.txt
```
___
##### 5.7. Команда `i` (insert)

Вставить текст в начало строки:
Синтаксис: `i text`

Вставить строку с текстом перед строкой:
Синтаксис: 
```
sed 'i\
text' inputfile.txt
```

___
##### 5.8. Команда `c` (replace)

Удалить строки, указанные в `addr` и заменить их на `text`:
Синтаксис: `i text`

Удалить строки, указанные в `addr` и  заменить их на многострочный текст:
Синтаксис: 
```
sed 'i\
line1\
line2\
line3' inputfile.txt
```
Если строка подходит под паттерн - она будет заменена многострочным текстом.
Интервал строк считается одним вхождением. Все строки в этом интервале будут удалены и заменены на заданный многострочный текст.

___
##### 5.9. Команда `r` (read)

Синтаксис: `[addr]r filename`
Добавить содержимое файла после строк, подходящих под `addr`.

___
##### 5.10. Команда `w` (write)

Добавить подходящие строки в файл `filename`.
Синтаксис: `[addr]w filename`

Если адрес - регулярное выражение, то вместо этой команды можно использовать `grep`.
